graph TB
    subgraph "ğŸ–¥ï¸ UI LAYER - Pages & Routes"
        PostingsPage["/postings<br/>PostingsPage.tsx<br/>ğŸ“„ Lists all postings<br/>âœ… Fixed filters: type, category, domain<br/>âœ… Matched postings view"]
        MemberDashboard["/dashboard<br/>MemberDashboard.tsx<br/>ğŸ  Unified dashboard<br/>âœ… NO TABS<br/>âœ… Simplified architecture"]
    end

    subgraph "ğŸ¨ UI LAYER - Dashboard Components"
        MemberDashboard --> PersonalizedPosts["PersonalizedPosts.tsx<br/>âœ… Uses PostingCard<br/>âœ… Direct API calls<br/>âœ… No feed adapter"]
        MemberDashboard --> ActivityTimeline["ActivityTimeline.tsx<br/>âœ… Activity items only<br/>âœ… Filtered query<br/>NOT postings"]
        MemberDashboard --> StatsOverview["StatsOverview.tsx<br/>ğŸ“Š Stats widget"]
        MemberDashboard --> QuickActions["QuickActions.tsx<br/>âš¡ Action buttons"]
        MemberDashboard --> RecentConversations["RecentConversations.tsx<br/>ğŸ’¬ Chat previews"]
        MemberDashboard --> OpportunitiesSpotlight["OpportunitiesSpotlight.tsx<br/>ğŸ¯ Opportunities"]
        MemberDashboard --> DomainFocusCard["DomainFocusCard.tsx<br/>ğŸ“ Domain focus"]
        MemberDashboard --> RecommendedConnections["RecommendedConnections.tsx<br/>ğŸ‘¥ Connections<br/>âœ… Uses ConnectionCard"]
        MemberDashboard --> PendingActions["PendingActions.tsx<br/>ğŸ“‹ Action items<br/>âœ… Uses ActionCard"]
    end

    subgraph "ğŸ§© UI LAYER - Shared Components (NEW)"
        PostingCard["PostingCard.tsx<br/>âœ… CANONICAL<br/>Single source of truth<br/>Renders: badges, domains,<br/>tags, location, author, actions<br/>ğŸ’³ Shows posting ID<br/>âœ… Modern CommentInput"]
        CommentInput["CommentInput.tsx<br/>ğŸ’¬ Modern inline comment<br/>âœ… Replaces browser prompt()<br/>Keyboard shortcuts"]
        UserProfileCard["UserProfileCard.tsx<br/>ğŸ‘¤ Reusable profile display<br/>3 variants: compact/default/detailed"]
        ConnectionCard["ConnectionCard.tsx<br/>ï¿½ Reusable connection card<br/>âœ… Avatar, badges, actions"]
        ActionCard["ActionCard.tsx<br/>âš¡ Reusable action card<br/>âœ… Priority, progress, metadata"]
    end

    subgraph "ğŸŒ API LAYER - Services"
        APIService["APIService.ts<br/>ğŸ”Œ API Client<br/>Handles all HTTP requests"]
    end

    subgraph "ğŸŒ API LAYER - Endpoints"
        PostingsEndpoint["GET /api/postings/:id<br/>ğŸ“¡ Returns full posting<br/>with all joins"]
        PostingsListEndpoint["GET /api/postings<br/>ğŸ“¡ Returns posting list<br/>âœ… SINGLE SOURCE<br/>âœ… With full details<br/>No feed endpoint"]
        MatchedPostingsEndpoint["GET /api/postings/matched/:userId<br/>ğŸ¯ Returns matched postings<br/>âœ… Domain-based matching<br/>âœ… Uses user preferences"]
        CategoriesEndpoint["GET /api/postings/categories<br/>ğŸ“‘ Returns category list<br/>âœ… For filters"]
        LikeEndpoint["POST /api/postings/:id/like<br/>â¤ï¸ Like action"]
        CommentEndpoint["POST /api/postings/:id/comment<br/>ğŸ’¬ Comment action"]
        ShareEndpoint["POST /api/postings/:id/share<br/>ğŸ“¤ Share action"]
    end

    subgraph "ğŸ’¾ DATABASE LAYER"
        PostingsTable[("POSTINGS<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>id PK<br/>title<br/>content<br/>author_id FK<br/>created_at<br/>published_at<br/>status<br/>posting_type<br/>âœ… offer_support / seek_support<br/>category_name<br/>location<br/>location_type<br/>urgency_level")]
        
        UsersTable[("APP_USERS<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>id PK<br/>first_name<br/>last_name<br/>âœ… Fixed NULL names<br/>email")]
        
        TagsTable[("TAGS<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>id PK<br/>name")]
        
        DomainsTable[("DOMAINS<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>id PK<br/>name<br/>level<br/>âœ… Fixed assignments")]
        
        LikesTable[("LIKES<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>id PK<br/>posting_id FK<br/>user_id FK")]
        
        PostingTagsJoin[("posting_tags<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>posting_id FK<br/>tag_id FK")]
        
        PostingDomainsJoin[("posting_domains<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>posting_id FK<br/>domain_id FK<br/>âœ… Corrected data")]
        
        ActivityFeed[("ACTIVITY_FEED<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>id PK<br/>user_id FK<br/>item_type<br/>âœ… Filtered: connection,<br/>event, achievement")]
    end

    subgraph "âœ… ARCHITECTURAL IMPROVEMENTS"
        Resolved1["âœ… Removed feed system<br/>routes/feed.js DELETED<br/>DashboardFeed.tsx DELETED<br/>FeedCard.tsx DELETED<br/>feedToPostingAdapter.ts DELETED<br/>500+ lines removed"]
        Resolved2["âœ… Unified dashboard<br/>Removed tabs (Overview/Feed)<br/>Single cohesive view<br/>Direct API integration"]
        Resolved3["âœ… Consistent posting display<br/>PostingCard used everywhere<br/>Same data source<br/>Modern CommentInput"]
        Resolved4["âœ… Fixed data quality<br/>Author names populated<br/>Domain assignments corrected<br/>ActivityTimeline filtered"]
        Resolved5["âœ… Fixed filters<br/>Type: offer_support/seek_support<br/>Category: dynamic loading<br/>Domain: working correctly"]
        Resolved6["âœ… New reusable components<br/>UserProfileCard (3 variants)<br/>ConnectionCard<br/>ActionCard<br/>CommentInput"]
    end

    subgraph "ğŸ”§ FIXES APPLIED"
        Fix1["ğŸ› Matched Postings<br/>Fixed domain assignments<br/>3 relevant vs 1 irrelevant<br/>Backend algorithm correct"]
        Fix2["ğŸ› Author Names<br/>Fixed NULL first_name/last_name<br/>150+ users updated<br/>No more 'null null'"]
        Fix3["ğŸ› Filter Values<br/>Updated to match DB schema<br/>offer_support / seek_support<br/>Dynamic category loading"]
        Fix4["ğŸ› UI Professional Polish<br/>Replaced browser prompt()<br/>Fixed overlapping content<br/>Responsive layouts"]
    end

    %% PostingsPage flow (CANONICAL PATH)
    PostingsPage -->|"fetches full postings"| APIService
    APIService -->|"GET /api/postings"| PostingsListEndpoint
    APIService -->|"GET /api/postings/matched/:userId"| MatchedPostingsEndpoint
    APIService -->|"GET /api/postings/categories"| CategoriesEndpoint
    PostingsListEndpoint -->|"queries with joins"| PostingsTable
    PostingsListEndpoint --> UsersTable
    PostingsListEndpoint --> TagsTable
    PostingsListEndpoint --> DomainsTable
    PostingsListEndpoint --> LikesTable
    MatchedPostingsEndpoint -->|"domain-based matching"| PostingsTable
    MatchedPostingsEndpoint --> DomainsTable
    MatchedPostingsEndpoint --> PostingDomainsJoin
    PostingsTable -->|"full posting objects"| PostingsPage
    PostingsPage -->|"âœ… canonical props"| PostingCard
    PostingCard -->|"modern comment UI"| CommentInput

    %% Dashboard PersonalizedPosts flow (SAME AS POSTINGS PAGE)
    PersonalizedPosts -->|"GET /api/postings"| APIService
    APIService -->|"full postings"| PersonalizedPosts
    PersonalizedPosts -->|"âœ… canonical props"| PostingCard

    %% Dashboard components using shared cards
    RecommendedConnections -->|"renders"| ConnectionCard
    PendingActions -->|"renders"| ActionCard

    %% ActivityTimeline (ACTIVITY ONLY - NO POSTINGS)
    ActivityTimeline -->|"filtered query"| ActivityFeed
    ActivityTimeline -.->|"âœ… renders activity only<br/>connections, events, achievements<br/>NO postings"| ActivityTimelineUI[Activity UI elements]

    %% API Service to endpoints
    APIService -->|"posting detail"| PostingsEndpoint
    APIService -->|"like action"| LikeEndpoint
    APIService -->|"comment action"| CommentEndpoint
    APIService -->|"share action"| ShareEndpoint

    %% Posting endpoint to DB (full joins)
    PostingsEndpoint -->|"full query"| PostingsTable
    PostingsEndpoint --> UsersTable
    PostingsEndpoint --> PostingTagsJoin
    PostingsEndpoint --> PostingDomainsJoin
    PostingsEndpoint --> LikesTable

    %% DB relationships
    PostingsTable ---|"author_id"| UsersTable
    PostingsTable ---|"many-to-many"| PostingTagsJoin
    PostingTagsJoin ---|"tag_id"| TagsTable
    PostingsTable ---|"many-to-many"| PostingDomainsJoin
    PostingDomainsJoin ---|"domain_id"| DomainsTable
    PostingsTable ---|"one-to-many"| LikesTable
    LikesTable ---|"user_id"| UsersTable
    ActivityTimeline ---|"queries"| ActivityFeed
    ActivityFeed ---|"user_id"| UsersTable

    %% Action handlers
    PostingCard -->|"onLike(posting.id)"| LikeEndpoint
    PostingCard -->|"onComment(posting.id)"| CommentEndpoint
    PostingCard -->|"onShare(posting.id)"| ShareEndpoint
    LikeEndpoint --> LikesTable

    %% Architecture highlights
    PersonalizedPosts -.-> Resolved1
    MemberDashboard -.-> Resolved2
    PostingCard -.-> Resolved3
    UsersTable -.-> Resolved4
    PostingsPage -.-> Resolved5
    ConnectionCard -.-> Resolved6
    ActionCard -.-> Resolved6
    UserProfileCard -.-> Resolved6
    CommentInput -.-> Resolved6

    %% Fixes applied
    MatchedPostingsEndpoint -.-> Fix1
    UsersTable -.-> Fix2
    PostingsListEndpoint -.-> Fix3
    CommentInput -.-> Fix4

    %% Styling
    classDef canonical fill:#22c55e,stroke:#16a34a,stroke-width:4px,color:#fff
    classDef resolved fill:#10b981,stroke:#059669,stroke-width:3px,color:#fff
    classDef database fill:#8b5cf6,stroke:#7c3aed,stroke-width:2px,color:#fff
    classDef api fill:#f59e0b,stroke:#d97706,stroke-width:2px,color:#fff
    classDef correct fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    classDef newComponent fill:#3b82f6,stroke:#2563eb,stroke-width:3px,color:#fff
    classDef fixes fill:#ef4444,stroke:#dc2626,stroke-width:2px,color:#fff

    class PostingCard,PostingsListEndpoint canonical
    class Resolved1,Resolved2,Resolved3,Resolved4,Resolved5,Resolved6 resolved
    class PostingsTable,UsersTable,TagsTable,DomainsTable,LikesTable,PostingTagsJoin,PostingDomainsJoin,ActivityFeed database
    class PostingsEndpoint,MatchedPostingsEndpoint,CategoriesEndpoint,LikeEndpoint,CommentEndpoint,ShareEndpoint,APIService api
    class PersonalizedPosts,ActivityTimeline,MemberDashboard,PostingsPage correct
    class CommentInput,UserProfileCard,ConnectionCard,ActionCard newComponent
    class Fix1,Fix2,Fix3,Fix4 fixes