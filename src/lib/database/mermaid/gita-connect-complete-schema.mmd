erDiagram
    %% ========================================
    %% CLEAN DATA SEPARATION ARCHITECTURE
    %% ========================================
    %% Alumni Members (Source Data from CSV Uploads)
    ALUMNI_MEMBERS ||--o{ USERS : links_to
    ALUMNI_MEMBERS ||--o{ USER_PROFILES : provides_data_for

    %% App Users (Authenticated Platform Users)
    USERS ||--o{ USER_PROFILES : has
    USERS ||--o{ USER_INVITATIONS : invited_by
    USERS ||--o{ USER_SESSIONS : creates
    USERS ||--o{ AUDIT_LOGS : generates

    %% User Profiles (Extended Information)
    USER_PROFILES ||--o{ USER_PREFERENCES : has

    %% Invitation System
    USER_INVITATIONS ||--o{ USERS : creates
    USER_INVITATIONS ||--o{ INVITATION_TOKENS : generates

    %% ========================================
    %% LEGACY TABLES (TO BE MIGRATED)
    %% ========================================
    %% Note: These tables exist but are being phased out
    %% in favor of the clean separation above

    %% ========================================
    %% POSTINGS & CONTENT MANAGEMENT
    %% ========================================
    USERS ||--o{ POSTINGS : creates
    POSTINGS ||--o{ POSTING_ATTACHMENTS : contains
    POSTINGS ||--o{ POSTING_INTERESTS : receives
    POSTINGS ||--o{ POSTING_CATEGORIES : categorized_as
    POSTINGS ||--o{ POSTING_DOMAINS : belongs_to
    POSTINGS ||--o{ MODERATION_DECISIONS : reviewed_by
    POSTINGS ||--o{ AUDIT_LOGS : tracked_in

    %% Interest & Help Requests
    USERS ||--o{ POSTING_INTERESTS : expresses
    POSTING_INTERESTS ||--o{ INTEREST_CONFIRMATIONS : receives
    POSTING_INTERESTS ||--o{ HELP_REQUESTS : creates
    HELP_REQUESTS ||--o{ HELP_RESPONSES : receives
    HELP_REQUESTS ||--o{ HELPER_RATINGS : rated_by

    %% ========================================
    %% CHAT & MESSAGING SYSTEM
    %% ========================================
    USERS ||--o{ CONVERSATIONS : participates_in
    USERS ||--o{ MESSAGES : sends
    USERS ||--o{ USER_TYPING : indicates_typing
    USERS ||--o{ NOTIFICATIONS : receives

    CONVERSATIONS ||--o{ CONVERSATION_PARTICIPANTS : has
    CONVERSATIONS ||--o{ MESSAGES : contains
    CONVERSATIONS ||--o{ USER_TYPING : tracks_typing
    CONVERSATIONS ||--o{ POSTING_CONVERSATIONS : linked_to

    MESSAGES ||--o{ MESSAGE_ATTACHMENTS : contains
    MESSAGES ||--o{ MESSAGE_REACTIONS : has

    %% Post-Linked Conversations
    POSTINGS ||--o{ POSTING_CONVERSATIONS : initiates
    POSTING_CONVERSATIONS ||--|| CONVERSATIONS : creates

    %% ========================================
    %% MODERATION & ADMINISTRATION
    %% ========================================
    USERS ||--o{ MODERATION_DECISIONS : makes
    MODERATION_DECISIONS ||--o{ MODERATION_ACTIONS : triggers
    MODERATION_DECISIONS ||--o{ AUDIT_LOGS : logged_in

    %% Spam Detection & Analytics
    POSTINGS ||--o{ SPAM_FLAGS : flagged_as
    USERS ||--o{ USER_BLOCKS : blocked_by
    POSTINGS ||--o{ ANALYTICS_EVENTS : tracked_in

    %% ========================================
    %% ANALYTICS & REPORTING
    %% ========================================
    POSTINGS ||--o{ POSTING_ANALYTICS : analyzed_in
    USERS ||--o{ USER_ANALYTICS : tracked_in
    CONVERSATIONS ||--o{ CONVERSATION_ANALYTICS : analyzed_in
    ANALYTICS_EVENTS ||--o{ ANALYTICS_REPORTS : generates

    %% ========================================
    %% CURRENT SCHEMA ENTITY DEFINITIONS
    %% ========================================

    %% Alumni Members (Source Data from CSV)
    ALUMNI_MEMBERS {
        int id PK
        varchar student_id UK
        varchar first_name
        varchar last_name
        varchar email
        int graduation_year
        varchar degree
        varchar department
        varchar phone
        text address
        timestamp created_at
        timestamp updated_at
        INDEX idx_email (email)
        INDEX idx_student_id (student_id)
    }

    %% App Users (Authenticated Platform Users)
    USERS {
        int id PK
        varchar email UK
        varchar password_hash
        enum status "active,inactive,suspended"
        int invitation_id FK
        timestamp created_at
        timestamp updated_at
        INDEX idx_email (email)
        INDEX idx_invitation_id (invitation_id)
    }

    %% User Profiles (Extended Information)
    USER_PROFILES {
        int id PK
        int user_id FK
        int alumni_member_id FK
        varchar first_name
        varchar last_name
        varchar display_name
        text bio
        varchar avatar_url
        varchar phone
        json social_links
        timestamp created_at
        timestamp updated_at
        INDEX idx_user_id (user_id)
        INDEX idx_alumni_member_id (alumni_member_id)
    }

    %% Invitation System
    USER_INVITATIONS {
        int id PK
        varchar token UK
        varchar email
        enum status "pending,sent,accepted,expired"
        int invited_by FK
        json invitation_data
        timestamp expires_at
        timestamp created_at
        timestamp accepted_at
        INDEX idx_token (token)
        INDEX idx_email (email)
    }

    INVITATION_TOKENS {
        int id PK
        int invitation_id FK
        varchar token UK
        enum token_type "invitation,password_reset"
        timestamp expires_at
        boolean is_used
        timestamp used_at
        timestamp created_at
    }

    %% ========================================
    %% LEGACY TABLES (DEPRECATED)
    %% ========================================
    %% Note: The following tables exist in the old schema but are
    %% being phased out in favor of the clean separation above.
    %% They will be migrated/removed in future phases.

    %% Sessions and Audit (Basic Implementation)
    USER_SESSIONS {
        int id PK
        int user_id FK
        varchar session_token UK
        timestamp expires_at
        varchar ip_address
        varchar user_agent
        timestamp created_at
    }

    AUDIT_LOGS {
        int id PK
        int user_id FK
        varchar action
        varchar resource_type
        int resource_id
        json old_values
        json new_values
        varchar ip_address
        varchar user_agent
        timestamp created_at
    }

    %% User Preferences (Basic Implementation)
    USER_PREFERENCES {
        int id PK
        int user_profile_id FK
        json preferences
        timestamp created_at
        timestamp updated_at
    }